<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Solve the EBNM problem — ebnm • ebnm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Solve the EBNM problem — ebnm"><meta property="og:description" content="Solves the empirical Bayes normal means (EBNM) problem using a specified
  family of priors. For a detailed introduction to the package, see
  Willwerscheid, Carbonetto, and Stephens (2025), our JSS article cited in
  References below."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ebnm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-38</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/ebnm" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Solve the EBNM problem</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/ebnm/blob/HEAD/R/ebnm.R" class="external-link"><code>R/ebnm.R</code></a>, <a href="https://github.com/stephenslab/ebnm/blob/HEAD/R/output.R" class="external-link"><code>R/output.R</code></a></small>
    <div class="hidden name"><code>ebnm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Solves the empirical Bayes normal means (EBNM) problem using a specified
  family of priors. For a detailed introduction to the package, see
  Willwerscheid, Carbonetto, and Stephens (2025), our JSS article cited in
  <strong>References</strong> below.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ebnm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior_family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point_normal"</span>, <span class="st">"point_laplace"</span>, <span class="st">"point_exponential"</span>, <span class="st">"normal"</span>,</span>
<span>    <span class="st">"horseshoe"</span>, <span class="st">"normal_scale_mixture"</span>, <span class="st">"unimodal"</span>, <span class="st">"unimodal_symmetric"</span>,</span>
<span>    <span class="st">"unimodal_nonnegative"</span>, <span class="st">"unimodal_nonpositive"</span>, <span class="st">"generalized_binary"</span>, <span class="st">"npmle"</span>,</span>
<span>    <span class="st">"deconvolver"</span>, <span class="st">"flat"</span>, <span class="st">"point_mass"</span>, <span class="st">"ash"</span><span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"estimate"</span>,</span>
<span>  g_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fix_g <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output <span class="op">=</span> <span class="fu">ebnm_output_default</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optmethod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ebnm_output_default</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ebnm_output_all</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector of observations. Missing observations (<code>NA</code>s) are
not allowed.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>A vector of standard errors (or a scalar if all are equal).
Standard errors may not be exactly zero, and
missing standard errors are not allowed. Two prior families have
additional restrictions: when horseshoe priors are used, errors
must be homoskedastic; and since function
<code><a href="https://bnaras.github.io/deconvolveR/reference/deconv.html" class="external-link">deconv</a></code> in package <code>deconvolveR</code> takes
\(z\)-scores, the "deconvolver" family requires that all standard errors
be equal to 1.</p></dd>


<dt id="arg-prior-family">prior_family<a class="anchor" aria-label="anchor" href="#arg-prior-family"></a></dt>
<dd><p>A character string that specifies the prior family
\(G\). See <strong>Details</strong> below.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>A scalar specifying the mode of the prior \(g\) or
<code>"estimate"</code> if the mode is to be estimated from the data. This
parameter is ignored by the NPMLE, the <code>deconvolveR</code> family,
and the improper uniform (or "flat") prior. For generalized binary priors,
which are bimodal, the mode parameter specifies the mode of the truncated
normal component (the location of the point mass is fixed at zero).</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>A scalar or vector specifying the scale parameter(s) of the
  prior or <code>"estimate"</code> if the scale parameters are to be estimated
  from the data. This parameter is ignored by the flat prior and the family
  of point mass priors.</p>
<p>The interpretation of <code>scale</code> depends on the prior
  family. For normal and point-normal families, it is a scalar
  specifying the standard deviation of the normal component. For
  point-Laplace and point-exponential families, it is a scalar specifying
  the scale parameter of the Laplace or exponential component. For the horseshoe
  family, it corresponds to \(s\tau\) in the usual parametrization of
  the <code><a href="horseshoe.html">horseshoe</a></code> distribution. For the family of generalized
  binary priors, it specifies the ratio of the (untruncated) standard
  deviation of the normal component to its mode.
  This ratio must be fixed in advance (i.e., argument <code>"estimate"</code> is
  unavailable for generalized binary priors). For the NPMLE and <code>deconvolveR</code>
  prior family, <code>scale</code> is a scalar specifying the distance between
  successive means in the grid of point masses or normal distributions
  used to estimate \(g\).
  For all other prior families, which are implemented using the function
  <code><a href="https://rdrr.io/pkg/ashr/man/ash.html" class="external-link">ash</a></code> in package <code>ashr</code>, it is a vector specifying
  the parameter <code>mixsd</code> to be passed to <code>ash</code> or <code>"estimate"</code>
  if <code>mixsd</code> is to be chosen by <code>ebnm</code>. (Note that <code>ebnm</code> chooses
  <code>mixsd</code> differently from <code>ash</code>: see functions
  <code><a href="ebnm_scale_normalmix.html">ebnm_scale_normalmix</a></code>, <code><a href="ebnm_scale_unimix.html">ebnm_scale_unimix</a></code>, and
  <code><a href="ebnm_scale_npmle.html">ebnm_scale_npmle</a></code> for details. To use the <code>ash</code> grid, set
  <code>scale = "estimate"</code> and pass in <code>gridmult</code> as an additional
  parameter. See <code><a href="https://rdrr.io/pkg/ashr/man/ash.html" class="external-link">ash</a></code> for defaults and details.)</p></dd>


<dt id="arg-g-init">g_init<a class="anchor" aria-label="anchor" href="#arg-g-init"></a></dt>
<dd><p>The prior distribution \(g\). Usually this is left
unspecified (<code>NULL</code>) and estimated from the data. However, it can be
used in conjuction with <code>fix_g = TRUE</code> to fix the prior (useful, for
example, to do computations with the "true" \(g\) in simulations). If
<code>g_init</code> is specified but <code>fix_g = FALSE</code>, <code>g_init</code>
specifies the initial value of \(g\) used during optimization. For
non-parametric priors, this has the side effect of fixing the <code>mode</code>
and <code>scale</code> parameters. If <code>g_init</code> is supplied, it should be
an object of class <code><a href="https://rdrr.io/pkg/ashr/man/normalmix.html" class="external-link">normalmix</a></code> for normal, point-normal,
scale mixture of normals, and <code>deconvolveR</code> prior families, as well as
for the NPMLE; class <code><a href="laplacemix.html">laplacemix</a></code> for
point-Laplace families; class <code><a href="gammamix.html">gammamix</a></code> for point-exponential
families; class <code><a href="horseshoe.html">horseshoe</a></code> for horseshoe families; class
<code><a href="https://rdrr.io/pkg/ashr/man/unimix.html" class="external-link">unimix</a></code> for <code>unimodal_</code> families; or class
<code><a href="https://rdrr.io/pkg/ashr/man/tnormalmix.html" class="external-link">tnormalmix</a></code> for generalized binary priors. An object of
class <code>ebnm</code> can also be supplied as argument, provided that field
<code>fitted_g</code> contains a prior of the correct class (see
<strong>Examples</strong> below).</p></dd>


<dt id="arg-fix-g">fix_g<a class="anchor" aria-label="anchor" href="#arg-fix-g"></a></dt>
<dd><p>If <code>TRUE</code>, fix the prior \(g\) at <code>g_init</code> instead
of estimating it.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>A character vector indicating which values are to be returned.
Function <code>ebnm_output_default()</code> provides the default return values, while
<code>ebnm_output_all()</code> lists all possible return values. See <strong>Value</strong>
below.</p></dd>


<dt id="arg-optmethod">optmethod<a class="anchor" aria-label="anchor" href="#arg-optmethod"></a></dt>
<dd><p>A string specifying which optimization function is to be
  used.</p>
<p>For parametric families other than the horseshoe and generalized binary
  (normal, point-normal, point-Laplace, and point-exponential), options
  include <code>"nlm"</code> (which calls <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>), <code>"lbfgsb"</code>
  (which calls <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>
  with <code>method = "L-BFGS-B"</code>), and <code>"trust"</code> (which
  calls into the <code><a href="https://rdrr.io/pkg/trust/man/trust.html" class="external-link">trust</a></code> package).
  Other options are <code>"nohess_nlm"</code>,
  <code>"nograd_nlm"</code>, and <code>"nograd_lbfgsb"</code>, which use numerical
  approximations rather than exact expressions for the Hessian; both of the
  <code>"nograd"</code> functions use numerical approximations for the gradient as
  well. The default option is <code>"nohess_nlm"</code>.</p>
<p>Since the horseshoe, generalized binary, and point mass families only require
  one parameter to be estimated (at most), the only available optimization method
  is <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize</a></code>, and thus the <code>optmethod</code> parameter is
  ignored by <code>ebnm_horseshoe</code>, <code>ebnm_generalized_binary</code>, and
  <code>ebnm_point_mass</code>.</p>
<p>For most nonparametric families (scale mixtures of normals; unimodal,
  symmetric unimodal, nonnegative unimodal, and nonpositive unimodal families;
  and the NPMLE), <code>optmethod</code> options are provided by package
  <code>ashr</code>. The default method uses the mix-SQP algorithm implemented in
  the <code>mixsqp</code> package. See the <code><a href="https://rdrr.io/pkg/ashr/man/ash.html" class="external-link">ash</a></code> function
  documentation for other options. For the NPMLE only, it is also possible to
  specify <code>optmethod = "REBayes"</code>, which uses function
  <code><a href="https://rdrr.io/pkg/REBayes/man/GLmix.html" class="external-link">GLmix</a></code> in the <code>REBayes</code> package to estimate
  the NPMLE rather than using the <code>ashr</code> package. Note that <code>REBayes</code>
  requires installation of the commercial interior-point solver MOSEK; for
  details, see the documentation for <code>REBayes</code> function
  <code><a href="https://rdrr.io/pkg/REBayes/man/KWDual.html" class="external-link">KWDual</a></code>.</p>
<p>The nonparametric exception is the the "deconvolveR" family. Since
  the <code>deconvolveR</code> package only ever uses <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>,
  <code>ebnm_deconvolver</code> ignores the <code>optmethod</code> parameter.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters to be passed to the optimization
function specified by parameter <code>optmethod</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters. When a <code>unimodal_</code> prior family is used,
these parameters are passed to function <code><a href="https://rdrr.io/pkg/ashr/man/ash.html" class="external-link">ash</a></code> in package
<code>ashr</code>. Although it
does not call into <code>ashr</code>, the scale mixture of normals family accepts
parameter <code>gridmult</code> for purposes of comparison. When <code>gridmult</code>
is set, an <code>ashr</code>-style grid will be used instead of the default
<code>ebnm</code> grid. When the "deconvolver" family is used, additional
parameters are passed to function <code><a href="https://bnaras.github.io/deconvolveR/reference/deconv.html" class="external-link">deconv</a></code> in
package <code>deconvolveR</code>. Families of generalized binary priors take several
additional parameters; see <code><a href="ebnm_generalized_binary.html">ebnm_generalized_binary</a></code>. In all
other cases, additional parameters are ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An <code>ebnm</code> object. Depending on the argument to <code>output</code>, the
  object is a list containing elements:</p><dl><dt><code>data</code></dt>
<dd><p>A data frame containing the observations <code>x</code>
        and standard errors <code>s</code>.</p></dd>

      <dt><code>posterior</code></dt>
<dd><p>A data frame of summary results (posterior
        means, standard deviations, second moments, and local false sign
        rates).</p></dd>

      <dt><code>fitted_g</code></dt>
<dd><p>The fitted prior \(\hat{g}\) (an object of
        class <code><a href="https://rdrr.io/pkg/ashr/man/normalmix.html" class="external-link">normalmix</a></code>, <code><a href="laplacemix.html">laplacemix</a></code>,
        <code><a href="gammamix.html">gammamix</a></code>, <code><a href="https://rdrr.io/pkg/ashr/man/unimix.html" class="external-link">unimix</a></code>,
        <code><a href="https://rdrr.io/pkg/ashr/man/tnormalmix.html" class="external-link">tnormalmix</a></code>, or <code><a href="horseshoe.html">horseshoe</a></code>).</p></dd>

      <dt><code>log_likelihood</code></dt>
<dd><p>The optimal log likelihood attained,
        \(L(\hat{g})\).</p></dd>

      <dt><code>posterior_sampler</code></dt>
<dd><p>A function that can be used to
        produce samples from the posterior. For all prior families other
        than the horseshoe, the sampler takes a single parameter
        <code>nsamp</code>, the number of posterior samples to return per
        observation. Since <code>ebnm_horseshoe</code> returns an MCMC sampler,
        it additionally takes parameter <code>burn</code>, the number of burn-in
        samples to discard.</p></dd>


</dl><p>S3 methods <code>coef</code>, <code>confint</code>, <code>fitted</code>, <code>logLik</code>,
   <code>nobs</code>, <code>plot</code>, <code>predict</code>, <code>print</code>, <code>quantile</code>,
   <code>residuals</code>, <code>simulate</code>, <code>summary</code>, and <code>vcov</code>
   have been implemented for <code>ebnm</code> objects. For details, see the
   respective help pages, linked below under <strong>See Also</strong>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Given vectors of data <code>x</code> and standard errors <code>s</code>, <code>ebnm</code>
  solves the "empirical Bayes normal means" (EBNM) problem for various
  choices of prior family.
  The model is $$x_j | \theta_j, s_j \sim N(\theta_j, s_j^2)$$
  $$\theta_j \sim g \in G,$$ where \(g\), which is referred to as the
  "prior distribution" for \(\theta\), is to be estimated from among
  some specified family of prior distributions \(G\). Several options
  for \(G\) are implemented, some parametric and others non-parametric;
  see below for examples.</p>
<p>Solving the EBNM problem involves
  two steps. First, \(g \in  G\) is estimated via maximum marginal likelihood:
  $$\hat{g} := \arg\max_{g \in G} L(g),$$ where
  $$L(g) := \prod_j \int p(x_j | \theta_j, s_j)  g(d\theta_j).$$
  Second, posterior distributions
  \(p(\theta_j | x_j, s_j, \hat{g})\) and/or summaries
  such as posterior means and posterior second moments are computed.</p>
<p>Implemented prior families include:</p><dl><dt><code>point_normal</code></dt>
<dd><p>The family of mixtures where one
        component is a point mass at \(\mu\) and the other is a normal
        distribution centered at \(\mu\).</p></dd>

      <dt><code>point_laplace</code></dt>
<dd><p>The family of mixtures where one
        component is a point mass at \(\mu\) and the other is a
        double-exponential distribution centered at \(\mu\).</p></dd>

      <dt><code>point_exponential</code></dt>
<dd><p>The family of mixtures where one
        component is a point mass at \(\mu\) and the other is a
        (nonnegative) exponential distribution with mode \(\mu\).</p></dd>

      <dt><code>normal</code></dt>
<dd><p>The family of normal distributions.</p></dd>

      <dt><code>horseshoe</code></dt>
<dd><p>The family of <a href="horseshoe.html">horseshoe</a> distributions.</p></dd>

      <dt><code>normal_scale_mixture</code></dt>
<dd><p>The family of scale mixtures of
        normals.</p></dd>

      <dt><code>unimodal</code></dt>
<dd><p>The family of all unimodal distributions.</p></dd>

      <dt><code>unimodal_symmetric</code></dt>
<dd><p>The family of symmetric unimodal
        distributions.</p></dd>

      <dt><code>unimodal_nonnegative</code></dt>
<dd><p>The family of unimodal
        distributions with support constrained to be greater than the mode.</p></dd>

      <dt><code>unimodal_nonpositive</code></dt>
<dd><p>The family of unimodal
        distributions with support constrained to be less than the mode.</p></dd>

      <dt><code>generalized_binary</code></dt>
<dd><p>The family of mixtures where one
        component is a point mass at zero and the other is a truncated
        normal distribution with lower bound zero and nonzero mode. See
        Liu et al. (2023), cited in <strong>References</strong> below.</p></dd>

      <dt><code>npmle</code></dt>
<dd><p>The family of all distributions.</p></dd>

      <dt><code>deconvolver</code></dt>
<dd><p>A non-parametric exponential family with
        a natural spline basis. Like <code>npmle</code>, there is no unimodal
        assumption, but whereas <code>npmle</code> produces spiky estimates for
        \(g\), <code>deconvolver</code> estimates are much more regular. See
        <code><a href="https://bnaras.github.io/deconvolveR/reference/deconvolveR-package.html" class="external-link">deconvolveR-package</a></code> for details and
        references.</p></dd>

      <dt><code>flat</code></dt>
<dd><p>The "non-informative" improper uniform prior, which
        yields posteriors $$\theta_j | x_j, s_j \sim N(x_j, s_j^2).$$</p></dd>

      <dt><code>point_mass</code></dt>
<dd><p>The family of point masses \(\delta_\mu\).
        Posteriors are point masses at \(\mu\).</p></dd>

      <dt><code>ash</code></dt>
<dd><p>Calls into function <code><a href="https://rdrr.io/pkg/ashr/man/ash.html" class="external-link">ash</a></code> in
        package <code>ashr</code>. Can be used to make direct comparisons of
        <code>ebnm</code> and <code>ashr</code> implementations of prior families such as
        scale mixtures of normals and the NPMLE.</p></dd>


</dl></div>
    <div id="functions">
    <h2>Functions</h2>

<ul><li><p><code>ebnm_output_default()</code>: Lists the default return values.</p></li>
<li><p><code>ebnm_output_all()</code>: Lists all valid return values.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Jason Willwerscheid, Peter Carbonetto, and Matthew Stephens (2025).
  <code>ebnm</code>: an <code>R</code> Package for solving the empirical Bayes
  normal means problem using a variety of prior families. <em>Journal of
  Statistical Software</em>, <strong>114</strong>(3), 1–33.
  <a href="https://doi.org/10.18637/jss.v114.i03" class="external-link">doi:10.18637/jss.v114.i03</a>
.</p>
<p>Yusha Liu, Peter Carbonetto, Jason Willwerscheid, Scott A Oakes,
  Kay F Macleod, and Matthew Stephens (2025). Dissecting tumor
  transcriptional heterogeneity from single-cell RNA-seq data by
  generalized binary covariance decomposition.  <em>Nature Genetics</em>
  <strong>57</strong>, 263–273. <a href="https://doi.org/10.1038/s41588-024-01997-z" class="external-link">doi:10.1038/s41588-024-01997-z</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>A plotting method is available for <code>ebnm</code> objects: see
  <code><a href="plot.ebnm.html">plot.ebnm</a></code>.</p>
<p>For other methods, see <code><a href="coef.ebnm.html">coef.ebnm</a></code>, <code><a href="confint.ebnm.html">confint.ebnm</a></code>,
   <code><a href="fitted.ebnm.html">fitted.ebnm</a></code>, <code><a href="logLik.ebnm.html">logLik.ebnm</a></code>,
   <code><a href="nobs.ebnm.html">nobs.ebnm</a></code>, <code><a href="predict.ebnm.html">predict.ebnm</a></code>,
   <code><a href="print.ebnm.html">print.ebnm</a></code>, <code><a href="print.summary.ebnm.html">print.summary.ebnm</a></code>,
   <code><a href="quantile.ebnm.html">quantile.ebnm</a></code>, <code><a href="residuals.ebnm.html">residuals.ebnm</a></code>,
   <code><a href="simulate.ebnm.html">simulate.ebnm</a></code>,
   <code><a href="summary.ebnm.html">summary.ebnm</a></code>, and <code><a href="vcov.ebnm.html">vcov.ebnm</a></code>.</p>
<p>Calling into functions <code><a href="ebnm_point_normal.html">ebnm_point_normal</a></code>,
  <code><a href="ebnm_point_laplace.html">ebnm_point_laplace</a></code>,
  <code><a href="ebnm_point_exponential.html">ebnm_point_exponential</a></code>, <code><a href="ebnm_normal.html">ebnm_normal</a></code>,
  <code><a href="ebnm_horseshoe.html">ebnm_horseshoe</a></code>,
  <code><a href="ebnm_normal_scale_mixture.html">ebnm_normal_scale_mixture</a></code>, <code><a href="ebnm_unimodal.html">ebnm_unimodal</a></code>,
  <code><a href="ebnm_unimodal_symmetric.html">ebnm_unimodal_symmetric</a></code>,
  <code><a href="ebnm_unimodal_nonnegative.html">ebnm_unimodal_nonnegative</a></code>,
  <code><a href="ebnm_unimodal_nonpositive.html">ebnm_unimodal_nonpositive</a></code>,
  <code><a href="ebnm_generalized_binary.html">ebnm_generalized_binary</a></code>, <code><a href="ebnm_npmle.html">ebnm_npmle</a></code>,
  <code><a href="ebnm_deconvolver.html">ebnm_deconvolver</a></code>, <code><a href="ebnm_flat.html">ebnm_flat</a></code>,
  <code><a href="ebnm_point_mass.html">ebnm_point_mass</a></code>, and <code><a href="ebnm_ash.html">ebnm_ash</a></code>
  is equivalent to calling into <code>ebnm</code> with <code>prior_family</code> set
  accordingly.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span>, <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following are equivalent:</span></span></span>
<span class="r-in"><span><span class="va">pn.res</span> <span class="op">&lt;-</span> <span class="fu">ebnm</span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, prior_family <span class="op">=</span> <span class="st">"point_normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pn.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_point_normal.html">ebnm_point_normal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect results:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">pn.res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -343.8873 (df=2)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pn.res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ebnm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fix the scale parameter:</span></span></span>
<span class="r-in"><span><span class="va">pl.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_point_laplace.html">ebnm_point_laplace</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate the mode:</span></span></span>
<span class="r-in"><span><span class="va">normal.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_normal.html">ebnm_normal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, mode <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">normal.res</span><span class="op">)</span> <span class="co"># posterior means shrink to a value different from zero</span></span></span>
<span class="r-plt img"><img src="ebnm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use an initial g (this fixes mode and scale for ash priors):</span></span></span>
<span class="r-in"><span><span class="va">normalmix.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_normal_scale_mixture.html">ebnm_normal_scale_mixture</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, g_init <span class="op">=</span> <span class="va">pn.res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fix g and get different output (including a posterior sampler):</span></span></span>
<span class="r-in"><span><span class="va">pn.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_point_normal.html">ebnm_point_normal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, g_init <span class="op">=</span> <span class="va">pn.res</span>, fix_g <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            output <span class="op">=</span> <span class="fu">ebnm_output_all</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample from the posterior:</span></span></span>
<span class="r-in"><span><span class="va">pn.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">pn.res</span>, nsim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quantiles and HPD confidence intervals can be obtained via sampling:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pn.quantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">pn.res</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pn.quantiles</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             10%       90%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.0000000 1.1914106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.0619459 0.1206053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000 1.7507120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.1512883 0.9017663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000 1.2735313</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">pn.res</span>, level <span class="op">=</span> <span class="fl">0.8</span>, parm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CI.lower   CI.upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.03860609 1.22003099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.05387886 0.06733079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.05568353 1.55045799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.06929657 1.08525964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.03277069 1.27950472</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examples of usage of control parameter:</span></span></span>
<span class="r-in"><span><span class="co">#  point_normal uses nlm:</span></span></span>
<span class="r-in"><span><span class="va">pn.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_point_normal.html">ebnm_point_normal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>print.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0000000 0.6123253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 160.1828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gradient:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.6458203  1.6594072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.06634847  0.48643374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 160.0995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gradient:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5.052228e-06 -5.652389e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relative gradient close to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current iterate is probably solution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">#  unimodal uses mixsqp:</span></span></span>
<span class="r-in"><span><span class="va">unimodal.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="ebnm_unimodal.html">ebnm_unimodal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">s</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running mix-SQP algorithm 0.3-54 on 201 x 7 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> convergence tol. (SQP):     1.0e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> conv. tol. (active-set):    1.0e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zero threshold (solution):  1.0e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zero thresh. (search dir.): 1.0e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l.s. sufficient decrease:   1.0e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> step size reduction factor: 7.5e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> minimum step size:          1.0e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max. iter (SQP):            1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max. iter (active-set):     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of EM iterations:    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing SVD of 201 x 7 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix is not low-rank; falling back to full matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter        objective max(rdual) nnz stepsize max.diff nqp nls</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 +7.073053156e-01  -- EM --    7 1.00e+00 1.02e-01  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 +6.300507676e-01  -- EM --    7 1.00e+00 9.84e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3 +5.856263291e-01  -- EM --    7 1.00e+00 8.30e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4 +5.605377271e-01  -- EM --    7 1.00e+00 6.48e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5 +5.463980593e-01  -- EM --    7 1.00e+00 4.86e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6 +5.383344434e-01  -- EM --    7 1.00e+00 3.59e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7 +5.336431001e-01  -- EM --    7 1.00e+00 2.65e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8 +5.308472577e-01  -- EM --    7 1.00e+00 1.96e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9 +5.291369016e-01  -- EM --    7 1.00e+00 1.46e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10 +5.280610563e-01  -- EM --    7 1.00e+00 1.09e-02  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11 +5.273636428e-01  -- EM --    7 1.00e+00 8.23e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12 +5.268961570e-01  -- EM --    7 1.00e+00 6.26e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13 +5.265707094e-01  -- EM --    7 1.00e+00 4.80e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14 +5.263343276e-01  -- EM --    7 1.00e+00 3.71e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15 +5.261546016e-01  -- EM --    7 1.00e+00 2.89e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16 +5.260114829e-01  -- EM --    7 1.00e+00 2.28e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17 +5.258924899e-01  -- EM --    7 1.00e+00 1.81e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18 +5.257898363e-01  -- EM --    7 1.00e+00 1.46e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19 +5.256986728e-01  -- EM --    7 1.00e+00 1.19e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20 +5.256159886e-01  -- EM --    7 1.00e+00 1.07e-03  --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 +5.255399164e-01 +4.382e-02   7  ------   ------   --  --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 +5.242991562e-01 +6.915e-03   4 1.00e+00 1.89e-02   5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3 +5.242979895e-01 +7.551e-05   4 1.00e+00 4.60e-04   2   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4 +5.242979894e-01 -2.385e-06   4 1.00e+00 5.87e-06   2   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization took 0.00 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence criteria met---optimal solution found.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jason Willwerscheid, Matthew Stephens, Peter Carbonetto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

